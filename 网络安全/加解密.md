---
title: 加解密
date: 2019-04-16 14:29:56
tags: 安全
---



## 前言：几个重要的概念

> 我们在学习信息安全加解密的过程中，首先要理解以下几个概念：单向不可逆加密、双向对称加密、密钥、双向非对称加密、公钥、私钥、签名/验签、数字证书 & CA(Certificate Authority)、SSL&TLS、KeyStore & Keytool。

1. 单向不可逆加密
    - 只能加密，不能解密的加密算法：MD5、SHA-1、SHA-256等等
2. 双向对称加密
    - 通信双方使用同一个密钥进行加解密：DES、AES等
3. 密钥（Secret）
    - 对称加密中双方共同使用的密码
4. 双向非对称加密
    - 通信中的密钥是成对的：公钥和私钥。用公钥加密，私钥解密。
    - 通信双方各自拥有自己的公钥和私钥：公钥A和私钥A、公钥B和私钥B。并将分别将公钥交由对方。A使用公钥B进行加密，使用私钥A进行签名。B使用私钥B解密，并使用公钥A进行验签。即使用接收方的公钥加密，接收方接收密文后使用自己的私钥解密。
    - 常见的公私钥非对称加密算法有：RSA
5. 公钥
    - 非对称加密算法中的公开的密钥
6. 私钥
    - 非对称加密算法中的自己秘密存储的密钥
7. 签名/验签
    - 发送方使用自己的私钥进行加密，接收方使用发送方的公钥进行解密。因为私钥只有发送方才有，防止三方伪造。
8. 数字证书&CA（Certificate Authority）
    - 数字证书由证书中心（CA）颁发，包含客户公钥和其他信息（公司名、域名），需要用证书中心的公钥进行解密。
    - CA是数字证书认证中心的简称，是指发放、管理、废除数字证书的机构。CA的作用是检查证书持有者身份的合法性，并用自己的私钥对客户的公钥和客户信息进行加密，生成数字证书，防止证书被伪造或篡改，以及对证书和密钥进行管理。
9. SSL&TLS
10. KeyStore&KeyTool


## 一、不可逆加密算法-MD5
### 概述
> MD5采用的是哈希算法（又称为散列函数，是一个单向加密体制，即从明文到密文的不可逆加密，只有加密没有解密。）哈希函数可以经过算法运算之后将任意长度的字符串转换成固定长度的密文。任意长度的字符串是无限的，而固定长度的哈希密文是有限的，因此密文和明文的关系就是一对多的关系。我们把不同的明文得到相同的密文称为碰撞。  

> MD5码采用128位的二进制数。最多有2^128种可能但是字符串的数量显然是有无数种可能的。    

> MD5的加密都是通过JavaSecurity提供的算法工具进行的。因此所有使用该算法的加密得到的密文都是相同的。因此保证不被破解，添加随机的固定盐值并加密，并确保盐值不被他人知晓。 

> 什么叫做不可逆：不可逆就是假如有两个密码3和4，我的加密算法很简单就是3+4，结果是7，但是通过7我不可能确定那两个密码是3和4，有很多种组合，这就是最简单的不可逆，所以只能通过暴力破解一个一个的试。

> 单向不可逆加密算法-MD5加密工具（速度最快，最容易破解）

> Java首先使用MessageDigest（消息摘要）获得MD5算法（也可以获得SHA-1、SHA-256等），然后直接调用digest方法加密明文（需要盐值，防止破解）

### 应用场景
1. 用户密码、口令加密。添加盐值进行加密；
2. 用于签名，验证目标文件是否被修改过。

### 破解方式
1. 穷举法

### 扩展
除了MD5加密算法之外，单向不可逆算法还有SHA-1、SHA-256等
1. 加密速度：MD5 > SHA-1 > SHA-256
2. 破解速度：SHA-256 > SHA-1 > MD5

## 二、AES加密
### 概述
> 双向对称加密算法

> 加密和解密的密钥相同。通过JavaSecurity提供的算法工具实现。步骤是，先通过SecretKeySpec将密钥转换成工具需要的形式，然后通过Cipher进行加密和解密。

### 应用场景
一般用于企业内部通讯的加解密。不用于敏感信息（资金交易）的加解密。

### 扩展
其他的双向对称加密算法有：DES、3AES。其中AES是DES的升级版。

## 三、RSA加密
### 应用场景
1. 公钥对交易信息进行加密，私钥对密文进行解密；
2. 私钥对数字摘要进行解密生成签名，公钥对签名进行解密。

针对A传递数据给B：
B的公钥加密、B的私钥解密、A的私钥加签、A的公钥验签。
加密是为了只有B能够解密。加签是为了证明是A传的数据。



## 数字证书