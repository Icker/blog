---
title: 如何排查问题
tags: 问题
categories: 问题
date: 2019-04-24 17:11:23
---

# 总思路

当线上出现问题，或者测试提出了bug的时候，我首先要明确的是**问题是什么**。不要觉得这是不是理所当然的嘛。其实，细想下就会发现，我经常会在没有搞清楚问题是什么或者理所当然的想当然。没分析明白，就觉得自己知道是什么问题了，然后立马去排查问题。结果弄了半天，发现问题不是我想的那个。浪费了精力，也没找到原因。

比如有一次，我改了一个关于下次跟进时间的bug。上线之后的某一天，测试说有个关于下次跟进记录的bug，你看看是不是和上次的一样，看不到自己的跟进记录。我在接收到这个bug的时候，我眼睛的重点是是不是和上次一样，然后我就让他把用户信息发我，开始吭呲吭呲排查，想要查看是不是之前的bug，结果看了半天，没有发现任何问题。之后明确到他说的是看不到自己的跟进记录，而不是之间的那个跟进记录的bug。

所以，当我接收到问题的时候，首先**不能想当然**。

我必须要**明确问题是什么**。

然后明白问题是什么之后，就要去明确造成这个问题的**具体现象**。

我可以通过**查询日志**还原用户操作，还原整个具体现象，从而**从现象中分析原因**，得到最终结果。





# 1. 根据对比，进行猜测

比如说同一个项目存在两个分支，即同一个功能两种实现方式，一个正常，一个错误，那么就要对比两者之间的不同点。根据不同点进行猜测问题在哪里。

举个例子：

运维反映给我网关存在问题，线上网关可以通过`actuator/info`获取他提供的版本信息，但测试环境不行。这个时候我发现线上网关是master，测试环境是修改版的其他分支branch。我首先做了对比，两者之间端点相关的配置区别在哪儿。结果发现master的端点配置放在了`application.yml`中，而branch的端点配置在`application-local.yml`中，我当前的项目中，后缀是local、dev、test、prod的配置都是通过远程的阿里云acm配置的，而application.yml才是本地配置。结合运维反馈给我的是，他会在项目启动过程中，服务还没启动之前会提供版本信息给服务。从而通过`actuator/info`来判断服务是否切换启动成功。因此我猜测获取运维的版本号信息只能是在本地获取，在动态加载阿里云的配置在修改版本之后，导致测试环境出现问题。因此我把端点相关配置调整到`application.yml`中，重启测试环境，果然成功获取版本号。

